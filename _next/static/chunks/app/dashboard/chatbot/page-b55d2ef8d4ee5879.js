(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[374],{8948:function(e,s,t){Promise.resolve().then(t.bind(t,5050))},5050:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return x}});var r=t(7437),a=t(2265),n=t(6463),i=t(7449),l=t(4080),d=t(1581),c=t(6264);function o(e){let{chatbotId:s,onUploadSuccess:t,onUploadError:n}=e,[l,o]=(0,a.useState)(!1),[m,x]=(0,a.useState)([]),u=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),h=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.items&&e.dataTransfer.items.length>0&&o(!0)},[]),p=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),o(!1)},[]),f=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),o(!1),g(Array.from(e.dataTransfer.files))},[]),j=(0,a.useCallback)(e=>{e.target.files&&g(Array.from(e.target.files))},[]),b=e=>["application/pdf","text/plain","text/markdown","application/x-markdown"].includes(e.type)||e.name.endsWith(".md")?e.size>10485760?"File size must be less than 10MB":null:"Only PDF, TXT, and MD files are supported",g=async e=>{let r=[];for(let s of e){let e=b(s);if(e){null==n||n(e);continue}r.push(s)}if(0===r.length)return;let a=r.map(e=>({file:e,progress:0,status:"uploading"}));x(e=>[...e,...a]);for(let e=0;e<r.length;e++){let a=r[e];try{x(e=>e.map(e=>e.file===a?{...e,progress:25}:e));let e=await c.h.uploadDocument(a,s);x(s=>s.map(s=>s.file===a?{...s,progress:50,status:"processing",documentId:e.document.id}:s)),await new Promise(e=>setTimeout(e,2e3)),x(e=>e.map(e=>e.file===a?{...e,progress:100,status:"completed"}:e)),null==t||t(e.document)}catch(e){console.error("Upload error:",e),x(s=>s.map(s=>s.file===a?{...s,status:"error",error:e.message||"Upload failed"}:s)),null==n||n(e.message||"Upload failed")}}},N=e=>{x(s=>s.filter(s=>s.file!==e))},v=e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"relative border-2 border-dashed rounded-2xl p-8 text-center transition-all duration-300 ".concat(l?"border-primary bg-primary/5 scale-[1.02]":"border-border hover:border-primary/50 hover:bg-muted/30"),onDragEnter:h,onDragLeave:p,onDragOver:u,onDrop:f,children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"mx-auto w-16 h-16 bg-primary/10 rounded-2xl flex items-center justify-center",children:(0,r.jsx)(d.rG,{className:"h-8 w-8 text-primary"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Upload Documents"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"Drag and drop your files here, or click to browse"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Supports PDF, TXT, and MD files up to 10MB"})]}),(0,r.jsxs)(i.z,{children:[(0,r.jsx)(d.rG,{className:"h-4 w-4 mr-2"}),"Choose Files"]}),(0,r.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.txt,.md",onChange:j,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]})}),m.length>0&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-foreground",children:"Processing Files"}),m.map((e,s)=>(0,r.jsxs)("div",{className:"bg-card p-4 rounded-xl border border-border/50",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,r.jsx)(d.zP,{className:"h-4 w-4 text-primary"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:e.file.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:v(e.file.size)})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:["uploading"===e.status&&(0,r.jsx)(d.Uj,{className:"h-4 w-4 text-primary animate-spin"}),"processing"===e.status&&(0,r.jsx)(d.Uj,{className:"h-4 w-4 text-brand animate-spin"}),"completed"===e.status&&(0,r.jsx)(d.ZU,{className:"h-4 w-4 text-green-600"}),"error"===e.status&&(0,r.jsx)(d.go,{className:"h-4 w-4 text-destructive"}),(0,r.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>N(e.file),className:"h-8 w-8 p-0",children:(0,r.jsx)(d.b0,{className:"h-4 w-4"})})]})]}),"error"!==e.status&&(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground mb-1",children:[(0,r.jsxs)("span",{children:["uploading"===e.status&&"Uploading...","processing"===e.status&&"Processing...","completed"===e.status&&"Completed"]}),(0,r.jsxs)("span",{children:[e.progress,"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-muted rounded-full h-2",children:(0,r.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat("completed"===e.status?"bg-green-600":"bg-primary"),style:{width:"".concat(e.progress,"%")}})})]}),"error"===e.status&&e.error&&(0,r.jsx)("div",{className:"text-sm text-destructive bg-destructive/10 p-2 rounded-lg",children:e.error})]},s))]})]})}function m(e){let{documents:s,onDocumentDelete:t,onDocumentUpdate:n}=e,[l,o]=(0,a.useState)({}),m=e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]},x=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),u=e=>(0,r.jsx)(d.zP,{className:"h-5 w-5"}),h=e=>{switch(e){case"ready":return(0,r.jsx)(d.ZU,{className:"h-4 w-4 text-green-600"});case"processing":return(0,r.jsx)(d.T3,{className:"h-4 w-4 text-brand"});case"error":return(0,r.jsx)(d.go,{className:"h-4 w-4 text-destructive"});default:return(0,r.jsx)(d.T3,{className:"h-4 w-4 text-muted-foreground"})}},p=e=>{switch(e){case"ready":return"Ready";case"processing":return"Processing";case"error":return"Error";default:return"Unknown"}},f=e=>{switch(e){case"ready":return"status-active";case"processing":return"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-brand/10 text-brand";case"error":return"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-destructive/10 text-destructive";default:return"status-inactive"}},j=async e=>{if(confirm("Are you sure you want to delete this document? This action cannot be undone.")){o(s=>({...s,[e]:!0}));try{await c.h.deleteDocument(e),null==t||t(e),null==n||n()}catch(e){console.error("Delete error:",e),alert(e.message||"Failed to delete document")}finally{o(s=>({...s,[e]:!1}))}}};return 0===s.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"mx-auto w-16 h-16 bg-muted rounded-2xl flex items-center justify-center mb-4",children:(0,r.jsx)(d.zP,{className:"h-8 w-8 text-muted-foreground"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No documents uploaded"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-6 max-w-sm mx-auto",children:"Upload your first document to start training your chatbot with your business knowledge."})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("h3",{className:"text-lg font-semibold",children:["Documents (",s.length,")"]})}),(0,r.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,r.jsxs)("div",{className:"bg-card p-6 rounded-2xl border border-border/50 hover:shadow-lg transition-all duration-300",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"p-3 bg-primary/10 rounded-xl flex-shrink-0",children:u(e.fileType)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-1",children:[(0,r.jsx)("h4",{className:"font-medium text-foreground truncate",children:e.fileName}),(0,r.jsxs)("div",{className:f(e.status),children:[h(e.status),(0,r.jsx)("span",{className:"ml-1",children:p(e.status)})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[(0,r.jsx)("span",{children:m(e.fileSize)}),(0,r.jsx)("span",{children:"•"}),(0,r.jsxs)("span",{children:["Uploaded ",x(e.uploadedAt)]})]})]})]}),(0,r.jsx)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:(0,r.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>j(e.id),disabled:l[e.id],className:"text-muted-foreground hover:text-destructive",children:l[e.id]?(0,r.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}):(0,r.jsx)(d.Bf,{className:"h-4 w-4"})})})]}),"error"===e.status&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-destructive/10 border border-destructive/20 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center text-sm text-destructive",children:[(0,r.jsx)(d.go,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,r.jsx)("span",{children:"Failed to process this document. Please try uploading again."})]})}),"processing"===e.status&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-brand/10 border border-brand/20 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center text-sm text-brand",children:[(0,r.jsx)(d.T3,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,r.jsx)("span",{children:"Processing document and generating embeddings..."})]})})]},e.id))})]})}function x(){var e;let s=(0,n.useRouter)(),t=(0,n.useSearchParams)().get("id"),[x,u]=(0,a.useState)(null),[h,p]=(0,a.useState)([]),[f,j]=(0,a.useState)(!0),[b,g]=(0,a.useState)("overview"),[N,v]=(0,a.useState)("");(0,a.useEffect)(()=>{t?y():(v("No chatbot ID provided"),j(!1))},[t]);let y=async()=>{if(t)try{j(!0);let[e,s]=await Promise.all([c.h.getChatbot(t),c.h.getDocuments(t).catch(()=>({documents:[]}))]);e.chatbot?u(e.chatbot):v("Chatbot not found"),p(s.documents||[])}catch(e){console.error("Failed to load chatbot data:",e),v(e.message||"Failed to load chatbot")}finally{j(!1)}};return f?(0,r.jsx)(l.a,{children:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})})}):N||!x?(0,r.jsx)(l.a,{children:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(d.go,{className:"h-16 w-16 text-destructive mx-auto mb-4"}),(0,r.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Chatbot Not Found"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-6",children:N||"The requested chatbot could not be found."}),(0,r.jsxs)(i.z,{onClick:()=>s.push("/dashboard"),children:[(0,r.jsx)(d.LZ,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})]})})}):(0,r.jsx)(l.a,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsx)("header",{className:"sticky top-0 z-50 bg-background/80 backdrop-blur-md border-b border-border/40",children:(0,r.jsxs)("div",{className:"container mx-auto px-6 py-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>s.push("/dashboard"),className:"text-muted-foreground hover:text-foreground",children:"← Back to Dashboard"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-2 bg-primary/10 rounded-xl",children:(0,r.jsx)(d.Z8,{className:"h-6 w-6"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-semibold",children:x.name}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:x.domain})]}),x?x.isActive&&x.isVerified?(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[(0,r.jsx)(d.ZU,{className:"h-3 w-3 mr-1"}),"Active"]}):x.isVerified?(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[(0,r.jsx)(d.T3,{className:"h-3 w-3 mr-1"}),"Inactive"]}):(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[(0,r.jsx)(d.go,{className:"h-3 w-3 mr-1"}),"Pending Verification"]}):null]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)(i.z,{variant:"outline",size:"sm",children:[(0,r.jsx)(d.ew,{className:"h-4 w-4 mr-2"}),"Settings"]}),(0,r.jsxs)(i.z,{size:"sm",className:"btn-hover",children:[(0,r.jsx)(d.NJ,{className:"h-4 w-4 mr-2"}),"Test Chat"]})]})]}),(0,r.jsx)("nav",{className:"flex space-x-8 mt-6",children:[{id:"overview",label:"Overview",icon:d.Z8},{id:"documents",label:"Documents",icon:d.zP},{id:"settings",label:"Settings",icon:d.ew},{id:"embed",label:"Embed Code",icon:d.n9}].map(e=>(0,r.jsxs)("button",{onClick:()=>g(e.id),className:"flex items-center space-x-2 pb-3 border-b-2 transition-colors ".concat(b===e.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),children:[(0,r.jsx)(e.icon,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"font-medium",children:e.label})]},e.id))})]})}),(0,r.jsxs)("div",{className:"container mx-auto px-6 py-8",children:["overview"===b&&(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"bg-card p-6 rounded-2xl border border-border/50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Conversations"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:(null===(e=x.stats)||void 0===e?void 0:e.conversationsCount)||0})]}),(0,r.jsx)("div",{className:"p-3 bg-brand/10 rounded-xl",children:(0,r.jsx)(d.NJ,{className:"h-6 w-6 text-brand"})})]})}),(0,r.jsx)("div",{className:"bg-card p-6 rounded-2xl border border-border/50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Documents"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:h.length})]}),(0,r.jsx)("div",{className:"p-3 bg-green-100 rounded-xl",children:(0,r.jsx)(d.zP,{className:"h-6 w-6 text-green-600"})})]})}),(0,r.jsx)("div",{className:"bg-card p-6 rounded-2xl border border-border/50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:x.isActive&&x.isVerified?"Live":"Offline"})]}),(0,r.jsx)("div",{className:"p-3 bg-purple-100 rounded-xl",children:(0,r.jsx)(d.n9,{className:"h-6 w-6 text-purple-600"})})]})})]}),(0,r.jsxs)("div",{className:"bg-card p-8 rounded-2xl border border-border/50",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-6",children:"Configuration"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Welcome Message"}),(0,r.jsx)("p",{className:"text-foreground mt-1",children:x.welcomeMessage})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Theme"}),(0,r.jsx)("p",{className:"text-foreground mt-1 capitalize",children:x.theme})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Position"}),(0,r.jsx)("p",{className:"text-foreground mt-1 capitalize",children:x.position.replace("-"," ")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Created"}),(0,r.jsx)("p",{className:"text-foreground mt-1",children:new Date(x.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})]})]}),"documents"===b&&(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)(o,{chatbotId:t,onUploadSuccess:e=>{p(s=>[e,...s])},onUploadError:e=>v(e)}),(0,r.jsx)(m,{documents:h,onDocumentDelete:e=>{p(s=>s.filter(s=>s.id!==e))},onDocumentUpdate:y})]}),"settings"===b&&(0,r.jsxs)("div",{className:"bg-card p-8 rounded-2xl border border-border/50",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-6",children:"Chatbot Settings"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Settings management coming soon..."})]}),"embed"===b&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-card p-8 rounded-2xl border border-border/50",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Embed Your Chatbot"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-6",children:"Copy and paste this code into your website to add your chatbot."}),(0,r.jsx)("div",{className:"bg-muted p-4 rounded-lg font-mono text-sm overflow-x-auto",children:(0,r.jsx)("code",{children:'<script>\n  window.salvebotConfig = {\n    chatbotId: "'.concat(t,'",\n    theme: "').concat(x.theme,'",\n    position: "').concat(x.position,'"\n  };\n</script>\n<script src="https://salvebot-api.fideleamazing.workers.dev/api/chat/widget.js"></script>')})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 mt-4",children:[(0,r.jsx)(i.z,{onClick:()=>{(null==x?void 0:x.embedCode)&&(navigator.clipboard.writeText(x.embedCode),alert("Embed code copied to clipboard!"))},children:"Copy Code"}),(0,r.jsxs)(i.z,{variant:"outline",children:[(0,r.jsx)(d.n9,{className:"h-4 w-4 mr-2"}),"Test Integration"]})]})]}),!x.isVerified&&(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 p-6 rounded-2xl",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)(d.go,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-yellow-800",children:"Domain Verification Required"}),(0,r.jsxs)("p",{className:"text-yellow-700 mt-1",children:["You need to verify ownership of ",x.domain," before your chatbot can go live."]}),(0,r.jsx)(i.z,{variant:"outline",size:"sm",className:"mt-3",children:"Verify Domain"})]})]})})]})]})]})})}},4080:function(e,s,t){"use strict";t.d(s,{a:function(){return l}});var r=t(7437),a=t(2265),n=t(6463),i=t(6264);function l(e){let{children:s,redirectTo:t="/signin"}=e,l=(0,n.useRouter)(),[d,c]=(0,a.useState)(null),[o,m]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{(async()=>{if(!i.d.getToken()){c(!1),m(!1);return}try{let e=await i.h.me();e.user||e.token?c(!0):(i.d.removeToken(),c(!1))}catch(e){console.error("Auth verification failed:",e),i.d.removeToken(),c(!1)}finally{m(!1)}})()},[]),(0,a.useEffect)(()=>{!1!==d||o||l.push(t)},[d,o,l,t]),o)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):d?(0,r.jsx)(r.Fragment,{children:s}):null}},6463:function(e,s,t){"use strict";var r=t(1169);t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[957,402,971,23,744],function(){return e(e.s=8948)}),_N_E=e.O()}]);